# =============================================================================
# REMOTE DEV SERVER OVERRIDE (Lightsail Instance)
# =============================================================================
# This file is for the remote dev server using managed Lightsail PostgreSQL.
# NO local postgres container - connects to managed database with SSL.
# Usage: docker compose -f docker-compose.yml -f docker-compose.remote.yml --env-file .env.remote up -d
# =============================================================================

services:
  # API - Production mode, no postgres dependency, SSL enabled
  api:
    environment:
      NODE_ENV: production
      DB_SSL: "true"
    # No volumes needed - code is built into container
    # No postgres dependency - using managed database

  # Web - Production mode
  web:
    build:
      args:
        NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL}
        NEXT_PUBLIC_SOCKET_URL: ${NEXT_PUBLIC_SOCKET_URL}
        NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME: ${NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME}
        NEXT_PUBLIC_FONTAWESOME_KIT: ${NEXT_PUBLIC_FONTAWESOME_KIT}
        NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY: ${NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY}
        NEXTAUTH_URL: ${NEXTAUTH_URL}
        NEXTAUTH_SECRET: ${NEXTAUTH_SECRET}
        INTERNAL_API_URL: ${INTERNAL_API_URL}
    environment:
      NODE_ENV: production
    # No volumes needed - code is built into container